<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnalul Sufletului</title>

    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>

<body>

    <div class="container">
        <h1>Jurnalul Sufletului</h1>
        <p class="subtitle">Respiră adânc. Ești în siguranță. Scrie pentru tine.</p>

        <div class="date-box" id="today"></div>

        <textarea id="textInput" placeholder="Scrie aici gândurile tale..."></textarea>

        <!-- Upload foto -->
        <input type="file" id="photoUpload" accept="image/*">

        <!-- Buton salvare -->
        <button id="saveBtn">Salvează în jurnal</button>

        <!-- Buton istoric -->
        <div class="center">
            <a href="istoric.html" class="history-btn">Vezi istoricul →</a>
        </div>
    </div>

<script>
    // Data curentă
    document.getElementById("today").textContent =
        new Date().toLocaleDateString("ro-RO", {
            day: "numeric",
            month: "long",
            year: "numeric"
        });

    // Salvare în localStorage (text + foto)
    document.getElementById("saveBtn").addEventListener("click", () => {
        let text = document.getElementById("textInput").value.trim();
        let photoInput = document.getElementById("photoUpload");
        let file = photoInput.files[0];

        if (text === "" && !file) {
            alert("Scrie ceva sau adaugă o poză înainte de a salva.");
            return;
        }

        let entries = JSON.parse(localStorage.getItem("jurnalEntries")) || [];

        function saveEntry(imageData = null) {
            entries.push({
                text: text,
                image: imageData,
                date: new Date().toISOString()
            });

            localStorage.setItem("jurnalEntries", JSON.stringify(entries));

            document.getElementById("textInput").value = "";
            photoInput.value = "";
            alert("Salvat!");
        }

        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                saveEntry(e.target.result);
            };
            reader.readAsDataURL(file);
        } else {
            saveEntry(null);
        }
    });

    // PWA
    if ("serviceWorker" in navigator) {
        navigator.serviceWorker.register("service-worker.js");
    }
</script>

</body>
</html>
